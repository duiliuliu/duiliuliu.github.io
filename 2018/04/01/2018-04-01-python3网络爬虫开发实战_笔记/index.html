<!DOCTYPE html>
<html lang="zh-CN">

  
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta name="author" content="对六, pengrui55555@163.com">
  
  
  
  <title>python3网络爬虫开发实战_笔记 | Duiliuliu</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="python,python 爬虫 笔记,">
  

  <script>
    console.log('\n%c github' + '%c 🎉 https://github.com/duiliuliu🎉\n' + '\n%c 简历 ' + '%c 🔍 https://godbmw.com/ 🔍  \n' , 'color: #fadfa3; background: #030307; padding:3px 0;', '', 'color: #fadfa3; background: #030307; padding:3px 0;', '');
  </script>

  
    <meta name="description" content="随笔">
  

  

  
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/icon/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">

  <script src="/js/util.js"></script>
<script src="/js/valine.min.js"></script>

  

  
    <link href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js" async></script>
  

  
    <link href="https://cdn.bootcss.com/social-share.js/1.0.16/css/share.min.css" rel="stylesheet">
  
  
  <script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js" async></script>
  
  
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.11.0/dist/av-min.js"></script>
  

</head>

  <body>

    

    <div id="app">

      <div class="header-wrap">
  <header>
    <div class="site-brand">
      <div class="site-title">
        <a href="/"><svg t="1524919571304" class="icon" style="margin-top: 5;margin-bottom: -5;margin-right: 10" viewbox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1405" xmlns:xlink="http://www.w3.org/1999/xlink" width="55" height="40"><defs><style type="text/css"/></defs><path d="M519.391852 655.664004l5.143137 0 0 0.765433-5.143137 0L519.391852 655.664004 519.391852 655.664004zM461.986421 953.196421l2.953262 1.055029c-7.259334-5.752004-25.818015-19.157315-49.984415-27.129894-28.747741-9.475815-71.581292-12.96529-112.364137 24.231891-0.464581 0.427742-1.047866 0.567935-1.685385 0.405229-9.751085-2.39249-51.969629-106.711394-89.576131-204.463742-2.042519 1.379417-4.027733 2.939959-6.100952 4.581342-3.653203 2.885723-7.614421 5.993504-12.480242 8.460696 47.004547 117.482715 94.16566 232.4307 101.068883 239.10368C336.773651 908.386866 394.807393 929.148725 461.986421 953.196421L461.986421 953.196421zM743.040539 950.431447c-0.64366 0.153496-1.221828 0.01842-1.685385-0.413416-40.797172-37.208437-83.647095-33.721009-112.413256-24.245194-24.045649 7.922437-42.522466 21.217231-49.841152 26.997887l0.271176-0.100284c62.594617-22.972201 127.316687-46.734394 170.756035 45.327348 6.707772-6.489808 51.394531-115.128087 97.024777-229.021044-0.511653-0.23536-1.004887-0.449231-1.455141-0.572028-7.698333-2.072195-13.239536-5.879917-17.913998-9.841136C791.466458 852.460112 752.374114 948.137195 743.040539 950.431447L743.040539 950.431447zM516.283048 657.190777l-0.227174-0.261966c-17.194614-19.894096-173.199691-193.161325-353.35377-152.168702-1.26583 1.962701 8.032954 21.381983 17.873066 39.153742l31.232328-0.881067-16.154935-28.411073 1.083681-0.173962c104.879676-16.950044 280.193517 111.976304 314.27166 137.992841l-0.839111 1.191128c0.949628 0.539282 1.882883 1.083681 2.788509 1.62501l1.503237 0.8913-1.678222 0.493234c-0.561795 0.165776-1.158383 0.98749-1.158383 2.176572l8.861832 291.0027c0 1.331321 0.73678 2.302439 1.391696 2.302439l1.596358 0c0.655939 0 1.39272-0.971118 1.39272-2.276856l8.862855-290.721291c0-1.109264-0.585331-1.935072-1.387603-1.935072l-3.568269 0 2.320858-1.413186c39.282678-23.985274 119.364575-51.532677 204.024743-70.176292 67.964928-14.969946 145.82011-25.104771 160.492274-8.645914l0.308015 0.339738-0.156566 0.429789c-1.726318 4.714372-15.611559 42.691311-34.417881 92.735078 7.316639 1.836835 15.287171 4.197602 22.308075 6.879688 19.531845-49.306986 37.231973-94.376461 49.724495-126.388549-193.349613-19.583011-353.160365 72.461335-397.590274 101.183494l-0.877997-1.251503c47.767933-36.480866 211.434503-154.25113 312.301795-137.948839l1.087774 0.173962-16.152888 28.373211 31.231305 0.813528c9.833973-17.700127 19.134803-37.052894 17.793248-39.065737-179.497117-40.803311-336.053756 133.669372-353.312838 153.699568l-0.233314 0.268106-1.399883 0 0-0.76748-1.685385 0-5.139044 0-1.676176 0 0 0.76748-1.436722 0L516.287141 657.190777zM148.189575 578.905806l-0.155543-0.429789 0.302899-0.339738c14.607696-16.381086 92.526323-6.441713 160.580279 8.316409 81.782631 17.73799 159.444409 43.61638 200.1239 66.535369-46.01808-29.54592-205.276247-120.142288-398.47134-100.571556 11.655458 29.860075 27.838022 71.071685 45.808302 116.484991 7.874341-2.036379 16.295128-3.63376 23.423479-4.684696C162.431951 617.877399 149.827889 583.38891 148.189575 578.905806L148.189575 578.905806zM132.757095 687.280072c-0.661056 3.91517 1.546216 7.232728 2.920516 8.857738 3.337002 3.950985 7.864108 5.516644 9.336646 4.588505 12.595876-7.907087 32.694633-14.82566 59.738569-20.556175 3.251044-0.691755 12.350283-3.613294 11.516288-7.858992-1.093914-5.564739-9.55461-6.729262-16.458857-6.729262-2.217505 0-4.13518 0.121773-5.285377 0.193405-0.446162 0.027629-0.788969 0.048095-1.01205 0.060375-10.218736 0.349971-37.748742 4.875031-52.061726 11.208273C137.895115 678.619832 133.426337 683.335227 132.757095 687.280072L132.757095 687.280072zM139.60813 715.676819c1.680269 5.915733 4.780887 8.92016 9.213849 8.92016 3.095501 0 5.754051-1.471514 6.494924-1.922792l0.682545-0.413416c6.164397-3.774977 24.920576-15.263635 53.91391-18.61701 12.890588-1.488911 27.972075-7.912204 27.364231-13.657045-0.200568-1.944282-0.806365-7.836479-13.252839-7.836479-6.547113 0-14.192234 1.555425-20.801768 3.065825-15.765055 3.62762-42.147936 11.713786-56.292074 17.975397C143.670655 704.632275 137.984143 709.941188 139.60813 715.676819L139.60813 715.676819zM218.057853 707.125049c-0.329505 0.039909-0.610914 0.075725-0.839111 0.098237-13.143345 1.228991-37.343513 7.423063-59.398832 18.119683-3.426029 1.664919-7.2798 5.961782-7.525394 9.998725-0.277316 4.604878 1.490957 7.504928 3.0208 9.127891 2.305509 2.455935 5.195326 3.327792 7.132444 3.327792 0.624217 0 1.181919-0.088004 1.659803-0.251733 9.397021-3.317559 16.104793-7.123234 22.596647-10.800997 5.963829-3.384074 12.132318-6.879688 20.165272-9.809413 0.285502-0.107447 1.013073-0.303922 2.061962-0.587378 20.999266-5.609765 23.64042-9.920954 23.344684-11.992125-0.727571-5.110391-3.53757-7.486508-8.836249-7.486508C220.122885 706.869223 218.927663 707.014532 218.057853 707.125049L218.057853 707.125049zM203.405131 732.825384l-0.410346 0.148379c-9.522887 3.355421-15.303544 7.039323-26.811646 14.386662-1.992377 1.2689-4.151553 2.648316-6.528694 4.151553-1.651616 1.041726-2.614547 2.178619-2.861164 3.37998-0.23536 1.167592 0.166799 2.520403 1.200338 4.019547 2.675946 3.873214 4.740978 4.323469 6.067182 4.323469l0 0c1.373277 0 2.78237-0.572028 4.14746-1.119497 0.998747-0.402159 2.034333-0.819668 3.072989-1.019213 9.760295-1.889023 16.008602-6.829546 22.056342-11.612479 2.744507-2.166339 5.335519-4.219091 8.185426-5.938246 0.172939-0.106424 0.397043-0.234337 0.665149-0.385786 1.984191-1.134847 7.261381-4.14746 7.975649-7.846712 0.280386-1.480724-0.189312-2.967588-1.441838-4.53734-0.436952-0.545422-1.512447-0.849344-3.037173-0.849344C211.464691 729.925335 205.399555 732.106 203.405131 732.825384L203.405131 732.825384zM840.178903 669.444868c-1.847068-0.25378-5.28026-0.727571-9.035794-0.727571-5.2864 0-11.860119 0.985444-13.140275 5.67014-1.133823 4.168949 7.723915 7.740288 10.924817 8.662287 26.551726 7.67889 46.101991 16.031115 58.096163 24.825408 0.320295 0.234337 0.816598 0.36225 1.431605 0.36225 2.163269 0 5.812379-1.608637 8.601912-4.682649 2.304486-2.530636 3.422959-5.446036 3.157923-8.204869-0.378623-3.985778-4.498454-9.014304-7.928576-10.842952-13.818727-7.351432-40.947598-13.848403-51.112098-14.938224C840.951499 669.544129 840.613808 669.500127 840.178903 669.444868L840.178903 669.444868zM884.934223 710.188828c-13.651928-7.259334-39.383986-17.234523-54.844096-21.988804-7.506974-2.300392-16.116049-4.657067-23.052019-4.657067-8.991792 0-10.737552 3.967358-11.266601 6.949272-1.013073 5.688559 13.563924 13.187347 26.307156 15.603373 28.65462 5.432733 46.536896 18.237363 52.40965 22.449291l0.666172 0.471744c0.797156 0.565888 3.65218 2.413979 7.014764 2.413979 4.086062 0 7.169283-2.778276 9.166777-8.258081C893.371382 717.571982 888.080889 711.866027 884.934223 710.188828L884.934223 710.188828zM872.474446 731.498156c-21.234627-12.267395-44.921095-20.191878-57.945737-22.361287-0.220011-0.035816-0.49528-0.094144-0.812505-0.155543-1.087774-0.217964-2.735297-0.547469-4.476965-0.547469-4.53734 0-7.231705 2.248204-8.238638 6.873548-0.444115 2.044566 1.88186 6.53995 22.425755 13.646811 1.02126 0.352017 1.730411 0.605797 2.00875 0.727571 7.798617 3.507894 13.69593 7.440459 19.404955 11.246135 6.206352 4.14132 12.619412 8.4126 21.75549 12.403494 0.584308 0.255827 1.324158 0.387833 2.145873 0.387833 4.308119 0 10.416234-3.63376 10.512425-11.70253C879.301945 737.969545 875.775632 733.406622 872.474446 731.498156L872.474446 731.498156zM826.860573 735.851301l-0.397043-0.173962c-5.692652-2.532683-9.987468-3.815909-12.769838-3.815909-0.799202 0-1.856277 0.11768-2.357697 0.653893-1.363044 1.480724-1.939165 2.923586-1.765203 4.420683 0.442068 3.739161 5.485945 7.125281 7.386224 8.396227 0.254803 0.176009 0.468674 0.318248 0.633427 0.431835 2.719948 1.922792 5.154393 4.155646 7.739265 6.52153 5.685489 5.202489 11.559267 10.585079 21.155832 13.168927 1.02433 0.276293 2.028193 0.76748 2.997264 1.245364 1.429559 0.701988 2.912329 1.425466 4.411473 1.425466 1.941212 0 3.90596-1.264806 6.006807-3.883447 1.137916-1.423419 1.638313-2.744507 1.487887-3.921309-0.159636-1.218758-1.035586-2.424212-2.610454-3.581572-2.254344-1.664919-4.296863-3.189645-6.186909-4.594645C841.634044 743.983515 836.128657 739.886197 826.860573 735.851301L826.860573 735.851301zM826.860573 735.851301" fill="#399ea8" p-id="1406"/><path d="M135.362432 563.761897 276.571525 933.502893 520.485767 949.820534 769.2689 928.898015 907.408073 569.735959 772.338818 563.761897 709.408557 592.759325 655.688052 602.819448 629.594767 611.177813 580.352249 626.183576 541.605783 641.875976 528.7725 657.190777 524.536013 656.429437 462.567659 626.183576 360.990193 594.972736 219.7811 563.761897Z" fill="#399ea8" p-id="1407"/><path d="M255.660262 315.224358c0 67.713194 26.611078 129.415488 70.39835 175.036525C182.678064 546.322713 83.941296 669.785629 83.941296 846.798159c0 160.327522 849.423963 184.136787 858.580506 0 8.902764-177.295985-94.468558-301.329906-241.517659-357.140003 43.214221-45.591361 69.799716-106.750279 69.799716-174.46552 0-140.746558-115.361401-254.883061-257.57231-254.883061S255.660262 174.446078 255.660262 315.224358L255.660262 315.224358zM312.896848 315.224358c0-109.611443 89.580225-198.247156 200.334701-198.247156 110.7555 0 200.334701 88.661296 200.334701 198.247156 0 79.30316-47.219441 147.848303-115.361401 179.556469C762.765789 532.729114 885.28624 650.555659 885.28624 825.02118c0 134.539182-744.106312 127.439484-744.106312 0 0-174.46552 122.493845-292.260343 287.054785-330.240353C360.118336 463.072661 312.896848 394.527518 312.896848 315.224358L312.896848 315.224358zM312.896848 315.224358" fill="#399ea8" p-id="1408"/><path d="M140.11262 579.11149 162.113703 626.183576 204.58091 566.575989 168.765193 563.761897Z" fill="#399ea8" p-id="1409"/><path d="M879.780853 641.875976 912.012951 574.340837 879.780853 563.761897 844.477812 563.761897 816.850591 569.736982Z" fill="#399ea8" p-id="1410"/></svg>Duiliuliu</a>
      </div>
    </div>
    <nav class="site-navigation">
      <ul class="nav-menu">
      
        <li class="nav-item" data-path="/">
          
            
            <a href="/" target="_self">
             <img src="/icon/主页.svg">
              主页
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/archives/">
          
            
            <a href="/archives/" target="_self">
             <img src="/icon/归档.svg">
              归档
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/categories/">
          
            
            <a href="/categories/" target="_self">
             <img src="/icon/分类.svg">
              分类
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/tags/">
          
            
            <a href="/tags/" target="_self">
             <img src="/icon/标签.svg">
              标签
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/about/">
          
            
            <a href="/about/" target="_self">
             <img src="/icon/关于我.svg">
              关于
            </a>
          
        </li>
      
      <!-- <li class="nav-item">
          <input type="text" id="local-search-input" style="width: 200px;" results="0"/>
      </li> -->
      </ul>
    </nav>
    <i class="iconfont icon-menu"></i>
  </header>
</div>

<script>
  let links = document.querySelectorAll('.nav-item');
  for(let link of links){
    let childrenLink = link.querySelector('ul');
    link.addEventListener('mouseenter', () => {
      if(childrenLink) {
        childrenLink.className = "nav-menu--dropdown active";
      }
    })
    link.addEventListener('mouseleave', () => {
      if(childrenLink) {
        childrenLink.className = "nav-menu--dropdown";
      }
    })
  }
  let rootRealPath = getRealPath(window.location.pathname, true);
  for(let link of links) {
    let linkPath = link.getAttribute("data-path");
    if(linkPath && getRealPath(linkPath, true) === rootRealPath) {
      link.className = "nav-item hover";
    }
  }

  let iconMenu = document.querySelector("i.iconfont.icon-menu"),
    iconMenuClicked = false;
  let navDOM = document.querySelector("nav.site-navigation");
  iconMenu.addEventListener("click", () => {
    iconMenuClicked 
      ? navDOM.className = "site-navigation active"
      : navDOM.className = "site-navigation";
    iconMenuClicked = !iconMenuClicked;
  })
</script>

      








<div class="container post-index">

  

<div class="post">
  <h1 class="article-title">
    <span>python3网络爬虫开发实战_笔记</span>
  </h1>
  <div class="article-top-meta">
    <span>
      发布 : 
      2018-04-01
    </span>
    
      <span>
        分类 : 
          <a href="/categories/python/">
            python
          </a>
      </span>
    
    
      <span>
        浏览 : <span class="article-timer" data-identity="2018-04-01-python3网络爬虫开发实战_笔记"></span>
      </span>
    
  </div>

  
    <div id="2018-04-01-python3网络爬虫开发实战_笔记" style="margin: 4rem 2px"></div>
<script async>
  (function(){
    let playerTimer = setInterval(function(){
      if(!window.APlayer){
        return
      }

      new APlayer({
        container: document.getElementById('2018-04-01-python3网络爬虫开发实战_笔记'),
        theme: '#e96900',
        listFolded: false,
        audio: [{"name":"Where are you","artist":"AniFace","url":"//music.163.com/song/media/outer/url?id=453843751.mp3","cover":"//p1.music.126.net/AUfXMljLBgB3PBV731IzRg==/109951162857118370.jpg?param=130y130"}]
      });
      
      clearInterval(playerTimer)
    }, 10);
  })()
</script>
  

  <div class="article-content">
    <div class="markdown-body">
      <h2 id="python3网络爬虫开发实战-笔记"><a href="#python3网络爬虫开发实战-笔记" class="headerlink" title="python3网络爬虫开发实战_笔记"></a>python3网络爬虫开发实战_笔记</h2><blockquote>
<p> <br> 《python3网络爬虫开发实战》 –崔庆才著<br> <br> 原文出处 <a href="https://germey.gitbooks.io/python3webspider/content/" target="_blank" rel="noopener">https://germey.gitbooks.io/python3webspider/content/</a><br> <br> window平台相关笔记</p>
</blockquote>
<h4 id="开发环境配置"><a href="#开发环境配置" class="headerlink" title="开发环境配置"></a><code>开发环境配置</code></h4><ul>
<li>python 官网安装<a href="https://www.python.org/" target="_blank" rel="noopener">python3</a> </li>
<li><a href="https://www.anaconda.com/download/" target="_blank" rel="noopener">Anaconda</a>安装</li>
<li><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="noopener">清华大学镜像</a> </p>
</li>
<li><p>会用到的包</p>
<ul>
<li>pip安装 ：  <code>pip install 包名</code>  </li>
<li>源码安装 ： 通过git下载源代码，进入文件目录 执行 <code>python3 setup.py install</code></li>
<li>requests 请求包</li>
<li>selenium 是一个自动化测试包<ul>
<li>需要浏览器驱动文件，并添加至环境变量</li>
<li><a href="https://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noopener">ChromeDriver</a> selenium用来驱动Chrome浏览器的驱动程序</li>
<li><a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener">GeckoDriver</a> selenium用来驱动Firefox浏览器的驱动程序</li>
<li><a href="http://phantomjs.org/download.html" target="_blank" rel="noopener">PhantomJS</a> 是一个无界面的、可脚本编程的webkit浏览器引擎  <a href="http://phantomjs.org/api/command-line.html" target="_blank" rel="noopener">api接口说明</a></li>
</ul>
</li>
<li>aiohttp 异步H请求 <code>pip install aiohttp</code></li>
<li>解析库<ul>
<li>lxml 解析html和xml的库，支持xpath，解析效率高效 <code>pip install lxml</code></li>
<li>beautifulsoup 解析html和xml的库 <code>pip install beautifulsoup</code></li>
<li>pyquery 同样强大的网页解析工具 <code>pip install pyquery</code></li>
</ul>
</li>
<li>tesserocr <br><br>OCR 即Option Character Recognition,光学识别符。tesserocr是python的一个OCR识别库，但其实是对tesseract的封装，所以也需要安装tesseract。 <code>pip install 。。。。</code></li>
<li><p>web库</p>
<ul>
<li>flask 是一个轻量级的文本服务程序 <code>pip install flask</code><br><br>测试<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&quot;/&quot;)</span><br><span class="line">def hello():</span><br><span class="line">    return &quot;hello world&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    app.run()</span><br><span class="line">```   </span><br><span class="line">*   tornado 是一个支持异步的web框架，通过使用非阻塞I/O流，它可以支持成千上万的开放连接，效率非常高 `pip install tornado`</span><br><span class="line">&lt;br&gt;测试</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>import tornado.ioloop<br>import tornado.web</p>
<p>class MainHandler(tornado.web.RequestHandler):</p>
<pre><code>def get(self):
    self.write(&quot;hello world&quot;)
</code></pre><p>def make_app():</p>
<pre><code>return tornado.web.Application([
    (r&quot;/&quot;,MainHandler),
])
</code></pre><p>if <strong>name</strong> == “<strong>main</strong>“:</p>
<pre><code>app = make_app()
app.listen(8888)
tornado.ioloop.IOloop.current().start()
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    *   App爬取相关的库</span><br><span class="line">        *   [Charles](https://www.charlesproxy.com/download) 是一个网络抓包工具，相比Fiddler，功能更加强大</span><br><span class="line">        &lt;br&gt;注: 抓https需要安装证书</span><br><span class="line">        *   mitmproxy 是一个支持http和https的抓包程序，类似Fiddler、Charles的功能，不过它通过控制台的形式操作</span><br><span class="line">            *   mitmdump 它是mitmproxy的命令行接口，可以利用它来对接python脚本</span><br><span class="line">            *   mitmweb 是一个web程序，可以通过它清除的观察mitmproxy捕获的请求</span><br><span class="line">            &lt;br&gt;`pip install mitmproxy` 或 https://github.com/mitmproxy/mitmproxy/releases/</span><br><span class="line">            &lt;br&gt;注: 抓https需要安装证书 </span><br><span class="line">        *   [Appium](https://github.com/appium/appium-desktop/releases) 是移动端的自动化测试工具，类似于前面所说的Selenium</span><br><span class="line"></span><br><span class="line">#### `数据读写`</span><br><span class="line">*   按照换行将question、 author、 answer写入文本整体以50个&apos;=&apos;分隔</span><br><span class="line">    ```  </span><br><span class="line">    with open(&apos;explore.txt&apos;, &apos;a&apos;, encoding=&apos;utf-8&apos;) as file:</span><br><span class="line">        file.write(&apos;\n&apos;.join([question, author, answer]))</span><br><span class="line">        file.write(&apos;\n&apos; + &apos;=&apos; * 50 + &apos;\n&apos;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>json数据需要用双引号包围，不能使用单引号，若使用如下形式，则会出现错误：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line"></span><br><span class="line">str = &apos;&apos;&apos;</span><br><span class="line">[&#123;</span><br><span class="line">    &apos;name&apos;: &apos;Bob&apos;,</span><br><span class="line">    &apos;gender&apos;: &apos;male&apos;,</span><br><span class="line">    &apos;birthday&apos;: &apos;1992-10-18&apos;</span><br><span class="line">&#125;]</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">data = json.loads(str)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 3 column 5 (char 8)</span><br></pre></td></tr></table></figure>
<p>因为这里数据用单引号来包围，loads()方法解析失败</p>
</li>
<li><p>csv文件的读写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import csv</span><br><span class="line"> </span><br><span class="line">with open(&apos;data.csv&apos;, &apos;w&apos;) as csvfile:</span><br><span class="line">    writer = csv.writer(csvfile)</span><br><span class="line">    writer.writerow([&apos;id&apos;, &apos;name&apos;, &apos;age&apos;])</span><br><span class="line">    writer.writerow([&apos;10001&apos;, &apos;Mike&apos;, 20])</span><br><span class="line">    writer.writerow([&apos;10002&apos;, &apos;Bob&apos;, 22])</span><br><span class="line">    writer.writerow([&apos;10003&apos;, &apos;Jordan&apos;, 21])</span><br></pre></td></tr></table></figure>
<ul>
<li>对于写入文件后会出现空行的解决 <code>open(&#39;data.csv&#39;,&#39;w&#39;,newline=&#39;&#39;)</code></li>
<li>如果想修改列与列之间的分隔符，可以传入delimiter参数，其代码如下：<code>csv.writer(csvfile, delimiter=&#39; &#39;)</code></li>
<li>writerows写入多行</li>
<li>字典读写 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fieldnames = [&apos;id&apos;, &apos;name&apos;, &apos;age&apos;]</span><br><span class="line">writer = csv.DictWriter(csvfile, fieldnames=fieldnames)</span><br><span class="line">writer.writeheader()</span><br><span class="line">writer.writerow(&#123;&apos;id&apos;: &apos;10001&apos;, &apos;name&apos;: &apos;Mike&apos;, &apos;age&apos;: 20&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a><code>数据库</code></h4><ul>
<li><p>关系数据库</p>
<ul>
<li>原子性(atomicity)  事务是一个不可分割的工作单位，事务中包括的诸操作要么全做，要么全不做</li>
<li>一致性(consistency)    事务必须使数据库从一个一致性状态变到另一个一致性状态。</li>
<li>隔离性(isolation)  一个事务的执行不能被其他事务干扰，即一个事物内部的操作及使用的数据</li>
<li>持久性(durability) 持续性也称永久性(permanence),指一个事务一旦提交，他对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    db.commit()</span><br><span class="line">except:</span><br><span class="line">    db.rollback()</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>什么是事务，为何用事务？</strong><blockquote>
<p>  保证数据的一致性和完整性，例子：银行存钱</p>
</blockquote>
</li>
</ul>
</li>
<li><p>非关系型数据库  </p>
<blockquote>
<ul>
<li>键值存储数据库：代表有Redis、Voldemort和Oracle BDB等。</li>
<li>列存储数据库：代表有Cassandra、HBase和Riak等。</li>
<li>文档型数据库：代表有CouchDB和MongoDB等。</li>
<li>图形数据库：代表有Neo4J、InfoGrid和Infinite Graph等。</li>
</ul>
</blockquote>
<ul>
<li>mongodb <ul>
<li>insert_one()和insert_many()方法来分别插入单条记录和多条记录</li>
<li>find_one()或find()方法进行查询</li>
<li>count()计数、sort()排序、skip()偏移</li>
<li>create_index()索引操作 或者 collection.ensure_index(‘user_name’, unique=True)</li>
</ul>
</li>
<li>redis<ul>
<li>数据类型： 键、字符串、列表(可重复)、有序集合、无序集合、散列</li>
<li>相应增删改查<blockquote>
<p>利用Redis维护代理池，Scrapy-Redis分布式架构，利用Redis实现布隆过滤</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="异步抓取"><a href="#异步抓取" class="headerlink" title="异步抓取"></a><code>异步抓取</code></h4><ul>
<li><p>ajax抓取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var xmlhttp;</span><br><span class="line">if (window.XMLHttpRequest) &#123;</span><br><span class="line">    // code for IE7+, Firefox, Chrome, Opera, Safari</span><br><span class="line">    xmlhttp=new XMLHttpRequest();</span><br><span class="line">&#125; else &#123;// code for IE6, IE5</span><br><span class="line">    xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">&#125;</span><br><span class="line">xmlhttp.onreadystatechange=function() &#123;</span><br><span class="line">    if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) &#123;</span><br><span class="line">        document.getElementById(&quot;myDiv&quot;).innerHTML=xmlhttp.responseText;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">xmlhttp.open(&quot;POST&quot;,&quot;/ajax/&quot;,true);</span><br><span class="line">xmlhttp.send();</span><br></pre></td></tr></table></figure>
<ul>
<li>随着网站的复杂度提升，越来越多的网站内容请求都是通过ajax请求的。</li>
<li>可通过浏览器开发者模式进行观察 <strong>XHR</strong>请求 或者 <strong>script</strong>请求</li>
<li><strong>XHR</strong>是正常的ajax请求，而<strong>script</strong>是jsonp跨域访问的请求，目前微服务架构中需要跨域访问资源，故而将数据作为js对象进行传输</li>
</ul>
</li>
</ul>
<h4 id="页面渲染"><a href="#页面渲染" class="headerlink" title="页面渲染"></a><code>页面渲染</code></h4><ul>
<li><p>selenium</p>
<ul>
<li>延时等待</li>
</ul>
<ol>
<li>time.sleep()</li>
<li>隐士等待    implicitly_wait()</li>
<li>显式等待<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">from selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as EC</span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">browser.get(&apos;https://www.taobao.com/&apos;)</span><br><span class="line">wait = WebDriverWait(browser, 10)</span><br><span class="line">input = wait.until(EC.presence_of_element_located((By.ID, &apos;q&apos;)))</span><br><span class="line">button = wait.until(EC.element_to_be_clickable((By.CSS_SELECTOR, &apos;.btn-search&apos;)))</span><br><span class="line">print(input, button)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>指定要查找的节点，然后指定一个最长等待时间，如果在规定时间里加载出了这个节点，就返回要查找的节点；如果到了规定时间依然没有加载出该节点，则抛出异常</p>
<ul>
<li>前进与后退</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">browser.get(&apos;https://www.python.org/&apos;)</span><br><span class="line">browser.back()</span><br><span class="line">time.sleep(1)</span><br><span class="line">browser.forward()</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Splash</strong> 是一个JavaScript渲染服务，是一个带有HTTP API的轻量级浏览器，同时它对接了Python中的Twisted和QT库。利用它，我们同样可以实现动态渲染页面的抓取<blockquote>
<p>  利用Splash，我们可以实现如下功能：<br>  异步方式处理多个网页渲染过程；<br>  获取渲染后的页面的源代码或截图；<br>  通过关闭图片渲染或者使用Adblock规则来加快页面渲染速度；<br>  可执行特定的JavaScript脚本；<br>  可通过Lua脚本来控制页面渲染过程；<br>  获取渲染的详细过程并通过HAR（HTTP Archive）格式呈现。<br>  接下来，我们来了解一下它的具体用法。</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a><code>验证码</code></h4><ul>
<li><p>验证码识别</p>
<ul>
<li><p>图形验证码<br>利用tesserocr库识别简单图片 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import tesserocr</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">image = Image.open(&apos;code.jpg&apos;)</span><br><span class="line">result = tesserocr.image_to_text(image)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>当图片有多余的线条等干扰时，需要额外的处理，如：转灰度，二值化...


**利用Image对象的convert()方法参数传入L,即可将图片转化为灰度图像**，如： 

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">image = image.convert(&apos;L&apos;)</span><br><span class="line">image.show()</span><br></pre></td></tr></table></figure>

**传入1即可将图片进行二值化处理** 

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">image = image.convert(&apos;1&apos;)</span><br><span class="line">image.show()</span><br></pre></td></tr></table></figure>


还可以指定二值化的阙值，上面的方法采用的是默认阙值127，不过我们不能直接转化原图，要将原图转化为灰度图像，然后在制定二值化阙值。如： 

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">image = image.convert(&apos;L&apos;)</span><br><span class="line">#threshold代表二值化阙值</span><br><span class="line">threshold = 80</span><br><span class="line">table = []</span><br><span class="line">for i in range(256):</span><br><span class="line">    if i &lt; threshold:</span><br><span class="line">        table.append(0)</span><br><span class="line">    else:</span><br><span class="line">        table.append(1)</span><br><span class="line"></span><br><span class="line">image = image.point(table,&apos;1&apos;)</span><br><span class="line">image.show()</span><br></pre></td></tr></table></figure>
</code></pre>
    </div>
  </div>
  
    <div class="copy-right">
      <div class="markdown-body">
        <blockquote>
        
        
          本文作者 : 对六 <br>
        
        原文链接 : <a href>http://duiliuliu.github.io/2018/04/01/2018-04-01-python3网络爬虫开发实战_笔记/</a><br>
        版权声明 : 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
        </blockquote>
      </div>
    </div>
  
  
  
    <div class="social-share" style="margin-top: -2rem" data-wechat-qrcode-title="<p>微信扫一扫</p>" data-wechat-qrcode-helper="<p>微信右上角, 扫一扫分享</p>" data-sites="douban, google, facebook, twitter">
  <span style="color: #6b7487; font-size: 1.4rem;">分享到: </span>
</div>
<script src="https://cdn.bootcss.com/social-share.js/1.0.16/js/social-share.min.js" async></script>
  

  
    <div id="reward">
  
    <p id="reward-meta">你我共勉！</p>
  
  <button id="reward-btn">
    
    <span>共勉</span>
  </button>
  <div id="reward-qrcode">
    
      <div class="reward-qrcode--container">
        <img class="qrcode-img" src="/images/wechat.png" alt="微信">
        <p class="qrcode-meta">微信</p>
      </div>
    
      <div class="reward-qrcode--container">
        <img class="qrcode-img" src="/images/alipay.png" alt="支付宝">
        <p class="qrcode-meta">支付宝</p>
      </div>
    
  </div>

</div>

<script>
  (() => {
    let button = document.querySelector('#reward-btn'),
      qrcode = document.querySelector('#reward-qrcode'),
      display = false;
    
    button.addEventListener('click', () => {
      qrcode.style.display = display ? 'none' : 'block'
      display = !display
    }, false)
  })()
</script>
  

  <div class="article-footer">
    <div class="article-meta pull-left">
      <span>
        
          <i class="iconfont icon-06tags"></i>标签: 
          
          <span class="span--tag">
            <a href="/tags/python-爬虫-笔记/">
              #python 爬虫 笔记
            </a>
          </span>
          
        
      </span>
    </div>
    <div class="article-meta pull-right">
    </div>
  </div>
</div>


  <aside id="sidebar">
    <p id="sidebar-header"></p>
    <ol id="sidebar-toc"></ol>
    <img id="sidebar-icon">
  </aside>
  <script async>setTimeout(generateToc, 10);</script>


  <nav class="post-navigation">
    
      <div class="nav-pre">
        <i class="iconfont icon-prev"></i>
        上一篇:
        <a href="/2018/03/13/python学习/" target="_self">python学习</a>
      </div>
    
    
      <div class="nav-next">
        下一篇:
        <a href="/2018/04/23/2018-04-23-Chrome开发者工具/" target="_self">Chrome开发者工具</a>
        <i class="iconfont icon-next"></i>
      </div>
    
  </nav>

  
    <a href="#comment" class="comment-anchor"></a>
<div class="comment-title"><i class="iconfont icon-footprint"></i> 留下足迹 <i class="iconfont icon-footprint"></i></div>
<div id="vcomments"></div>

<script defer>
  if( true ) {
    let path = getRealPath()
    new Valine({
      el: "#vcomments",
      appId: "VPNwETUGMJnwGnY6Pc7GaVna-gzGzoHsz",
      appKey: "niJbsuSCKuploWnG8Qvbgb5P",
      notify: false,
      verify: false,
      avatar: "robohash",
      placeholder: "正确填写邮箱, 才能及时收到回复哦♪(^∇^*)",
      path
    });
  }
</script>
   

  
    <script defer>
const valineAPI = (() => {
  try {
    AV.init("VPNwETUGMJnwGnY6Pc7GaVna-gzGzoHsz", "niJbsuSCKuploWnG8Qvbgb5P");
  } catch(error) {}
  const isExist = (identity) => {
    identity = identity || getRealPath();
    let query = new AV.Query('Timer');
    return new Promise((resolve, reject) => {
      query.equalTo("identity", identity);
      query.find().then(results => {
        resolve(results.length > 0);
      }, error => reject(error));
    })
  }

  const _get = (identity) => {
    let query = null;
    if(identity && identity instanceof Array){
      let querys = [];
      for(let i = 0; i < identity.length; ++i) {
        querys[i] = new AV.Query('Timer');
        querys[i].equalTo('identity', identity[i]);
      }
      query = AV.Query.or.apply(null ,querys);
    } else {
      identity = identity || getRealPath();
      query = new AV.Query("Timer");
      query.equalTo("identity", identity);
    }

    return new Promise((resolve, reject) => {
      query.find()
      .then(results => resolve(results))
      .catch(error => reject(error))
    })
  }

  const create = (identity) => {
    identity = identity || getRealPath();
    return new Promise((resolve, reject) => {
      let Todo = AV.Object.extend('Timer');
      let todo = new Todo();
      todo.set("times", 1);
      todo.set("identity", identity);
      todo.save().then(res => resolve(true), error => reject(error));
    })
  }

  const update = (identity) => {
    identity = identity || getRealPath();
    return new Promise((resolve, reject) => {
      let query = new AV.Query('Timer');
      query.equalTo("identity", identity);
      query.find().then(todos => {
        todos.forEach(todo => {
          todo.set("times", todo.attributes.times + 1);
        });
        return AV.Object.saveAll(todos);
      }).then(todos => resolve(true), error => reject(error));
    })
  }

  return {
    isExist,
    _get,
    update,
    create
  }
})()

const calcAndWriteTimes = () => {
  let isPost = true;

  let timerAllDOM = document.querySelectorAll(".article-timer");

  if(isPost) {
    let identity = timerAllDOM[0].getAttribute("data-identity");
    valineAPI.isExist(identity)
    .then(exist => {
      if(exist) {
        return valineAPI.update(identity);
      }
      return new Promise(resolve => resolve(true));
    })
    .then( succuess => valineAPI._get(identity))
    .then( result => timerAllDOM[0].innerText = result[0].attributes.times)
    .catch(error => console.log(error.message))
    return ;
  }

  let timerDOMCache = {};

  for(let timerDOM of timerAllDOM) {
    let identity = timerDOM.getAttribute("data-identity");
    if(timerDOMCache.hasOwnProperty(identity)){
      timerDOMCache[identity].dom.push(timerDOM);
    }else{
      timerDOMCache[identity] = {
        dom: [timerDOM],
        times: undefined
      };
    }
  }

  let identities = Object.keys(timerDOMCache);
  valineAPI._get(identities).then(results => {
    for(let result of results) {
      let {identity, times} = result.attributes;
      timerDOMCache[identity].times = times;
      timerDOMCache[identity].dom.map(item => item.innerText = times);
    }
    for(let identity of identities) {
      if(timerDOMCache[identity].times){
        continue;
      }
      timerDOMCache[identity].dom.map(item => item.innerText = 1);
      valineAPI.create(identity);
    }
  }).catch(error => console.log(error.message))
}

if(true){
  calcAndWriteTimes();
}
</script>
   

</div>


      <footer>
  <p class="site-info">
    博客已运行<span id="time-to-now"></span><span class="my-face">(●'◡'●)ﾉ♥</span>
    <br>
    Created By <a href="https://hexo.io/zh-cn/">Hexo</a> | Theme - <a href="https://github.com/dongyuanxin/theme-bmw">BMW</a>  
    <br>
    
      <a href="https://www.google.com/analytics/" target="_blank">Google Analytics</a> 提供网站统计服务.  <br> 
    
  </p>
</footer>



<script>
const timeToNowDOM = document.querySelector("#time-to-now");
const startTimestamp = new Date(2018, 1, 10).getTime();

const updateTimeStr = () => {
  let offset = parseInt(
      (new Date().getTime() - startTimestamp) / 1000,
      10
    ),
    day = Math.floor(offset / 86400),
    hour = Math.floor((offset % 86400) / 3600),
    minute = Math.floor(((offset % 86400) % 3600) / 60),
    second = Math.floor(((offset % 86400) % 3600) % 60);
  timeToNowDOM.innerHTML =
    day + "天" + hour + "小时" + minute + "分钟" + second + "秒";
  setTimeout(updateTimeStr, 500);
}

setTimeout(updateTimeStr, 500);
</script>


      <div class="back-to-top hidden">
  <span>
    <i class="iconfont icon-60"></i><span></span>%
  </span>
</div>

<script>
const updateIconToTop = percent => {
  let dom = document.querySelector(".back-to-top span span");
  dom.innerText = percent;
  if(percent < 1) {
    document.querySelector(".back-to-top").className = "back-to-top hidden";
  } else {
    document.querySelector(".back-to-top").className = "back-to-top";
  }
}

const handleScoll = () => {
  let isRunning = false;
  return () => {
    if (isRunning) return;
    isRunning = true;
    window.requestAnimationFrame(timestamp => {
      let scrollTop =
          document.documentElement.scrollTop || document.body.scrollTop,
        scrollHeight =
          document.documentElement.scrollHeight ||
          document.body.scrollHeight,
        clientHeight =
          document.documentElement.clientHeight ||
          document.body.clientHeight;
      isRunning = false;
      if (scrollTop <= 1) {
        updateIconToTop(0);
        return;
      }
      if (scrollTop + clientHeight >= scrollHeight) {
        updateIconToTop(100);
      } else {
        updateIconToTop(parseInt(
          100 * scrollTop / (scrollHeight - clientHeight),
          10
        ));
      }
    });
  };
}

const backToTop = () => {
  let scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop,
    delay = 10,
    time = 200;
  if (scrollTop <= 20) {
    document.documentElement.scrollTop = 0;
    document.body.scrollTop = 0;
    return;
  }
  let step = Math.ceil(scrollTop * delay / time);
  let timer = setInterval(() => {
    scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop;
    if (scrollTop - step <= 0) {
      document.documentElement.scrollTop = 0;
      document.body.scrollTop = 0;
      clearInterval(timer);
    } else {
      document.documentElement.scrollTop = scrollTop - step;
      document.body.scrollTop = scrollTop - step;
    }
  }, delay);
}

document.addEventListener("scroll", handleScoll(), false);

document.querySelector(".back-to-top").addEventListener("click", backToTop, false);

</script>

    </div>

    
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
  (() => {
    const mathjaxConfig = {
      showProcessingMessages: false, //关闭js加载过程信息
      messageStyle: "none", //不显示信息
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]], //行内公式选择符
        displayMath: [["$$", "$$"], ["\\[", "\\]"]], //段内公式选择符
        skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"] //避开某些标签
      },
      "HTML-CSS": {
        availableFonts: ["STIX", "TeX"], //可选字体
        showMathMenu: false //关闭右击菜单显示
      }
    }

    let mathjaxInterval = setInterval(() => {
      if(!window.MathJax){
        return;
      }
      window.MathJax.Hub.Config(mathjaxConfig)
      window.MathJax.Hub.Queue(["Typeset", MathJax.Hub, document.getElementById('app')])

      clearInterval(mathjaxInterval)
    }, 10)    
  })()
</script>
    

    <script src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script>
<script async>
  let fancyTimer = setInterval(function(){
    if(!window.$){
      return;
    }
    $(document).ready(function() {
      $(".post img").each(function () {
        if($(this).parent().get(0).tagName.toLowerCase() === "a") {
          return;
        }
        // $(this).attr("data-fancybox", "gallery"); // if you add 'data-fancybox', img will display after showed
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "gallery");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      });
      
      clearInterval(fancyTimer);
    });
  }, 10);
</script>

    
  </body>

</html>
